<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control - Servidor de Versiones GTAV Injector</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-rocket"></i>
                <h1>GTAV Injector - Control Panel</h1>
            </div>
            <div class="status-indicator" id="serverStatus">
                <i class="fas fa-circle"></i>
                <span>Conectando...</span>
            </div>
            <div id="authSection" class="auth-section">
                <div id="authInfo" class="auth-info hidden">
                    <span id="currentUser"></span>
                    <button id="logoutBtn" class="btn btn-small">Salir</button>
                </div>
                <div id="loginForm" class="login-form">
                    <input type="text" id="loginUser" placeholder="Usuario">
                    <input type="password" id="loginPass" placeholder="Contraseña">
                    <button id="loginBtn" class="btn btn-small btn-primary">Ingresar</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- Información actual de la versión -->
            <section class="card info-card">
                <div class="card-header">
                    <h2><i class="fas fa-info-circle"></i> Estado Actual</h2>
                </div>
                <div class="card-body">
                    <div class="info-grid">
                        <div class="info-item">
                            <label>Versión Actual:</label>
                            <span id="currentVersion" class="version-badge">Cargando...</span>
                        </div>
                        <div class="info-item">
                            <label>Última Actualización:</label>
                            <span id="lastUpdate">-</span>
                        </div>
                        <div class="info-item">
                            <label>Estado del Servidor:</label>
                            <span id="serverStatusText" class="status-online">Online</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gestión de versiones -->
            <section class="card version-card">
                <div class="card-header">
                    <h2><i class="fas fa-cog"></i> Gestión de Versiones</h2>
                </div>
                <div class="card-body">
                    <div class="version-form">
                        <div class="input-group">
                            <label for="newVersion">Nueva Versión:</label>
                            <input type="text" id="newVersion" placeholder="1.0.0" pattern="\d+\.\d+\.\d+">
                            <small class="help-text">Formato: x.y.z (ej: 1.0.0, 2.1.3)</small>
                        </div>
                        
                        <div class="input-group">
                            <label for="adminKey">Clave de Administrador:</label>
                            <input type="password" id="adminKey" placeholder="Ingresa la clave de admin (opcional - legacy)">
                        </div>

                        <div class="button-group">
                            <button id="updateVersionBtn" class="btn btn-primary">
                                <i class="fas fa-upload"></i> Actualizar Versión
                            </button>
                            <button id="validateBtn" class="btn btn-secondary">
                                <i class="fas fa-check"></i> Validar Formato
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Validación de clientes -->
            <section class="card validation-card">
                <div class="card-header">
                    <h2><i class="fas fa-shield-alt"></i> Validación de Clientes</h2>
                </div>
                <div class="card-body">
                    <div class="test-section">
                        <div class="input-group">
                            <label for="testVersion">Probar Versión del Cliente:</label>
                            <input type="text" id="testVersion" placeholder="1.0.0">
                        </div>
                        <button id="testValidationBtn" class="btn btn-info">
                            <i class="fas fa-flask"></i> Probar Validación
                        </button>
                    </div>
                    
                    <div id="validationResult" class="validation-result hidden"></div>
                </div>
            </section>

            <!-- Historial de versiones -->
            <section class="card history-card">
                <div class="card-header">
                    <h2><i class="fas fa-clock"></i> Historial de Versiones</h2>
                    <button id="refreshHistoryBtn" class="btn btn-small"><i class="fas fa-rotate"></i> Actualizar</button>
                </div>
                <div class="card-body">
                    <table class="table" id="historyTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Versión</th>
                                <th>Usuario</th>
                                <th>Fecha</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Auditoría -->
            <section class="card audit-card">
                <div class="card-header">
                    <h2><i class="fas fa-list"></i> Auditoría</h2>
                    <div class="filters">
                        <input type="text" id="auditQ" placeholder="Buscar...">
                        <input type="date" id="auditFrom">
                        <input type="date" id="auditTo">
                        <button id="refreshAuditsBtn" class="btn btn-small"><i class="fas fa-rotate"></i> Filtrar</button>
                        <button id="exportAuditsBtn" class="btn btn-small btn-secondary"><i class="fas fa-file-export"></i> Exportar CSV</button>
                    </div>
                </div>
                <div class="card-body">
                    <table class="table" id="auditTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Acción</th>
                                <th>Usuario</th>
                                <th>Detalles</th>
                                <th>Fecha</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Log de actividad (local de la UI) -->
            <section class="card log-card">
                <div class="card-header">
                    <h2><i class="fas fa-terminal"></i> Log de Actividad (UI)</h2>
                    <button id="clearLogBtn" class="btn btn-small btn-danger">
                        <i class="fas fa-trash"></i> Limpiar
                    </button>
                </div>
                <div class="card-body">
                    <div id="activityLog" class="activity-log">
                        <div class="log-entry">
                            <span class="timestamp">Sistema iniciado</span>
                            <span class="message">Panel de control cargado correctamente</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modal de confirmación -->
        <div id="confirmModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Confirmar Actualización</h3>
                    <button class="close-btn" id="closeModal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p>¿Estás seguro de que quieres actualizar la versión?</p>
                    <div class="version-comparison">
                        <div>Versión actual: <span id="modalCurrentVersion">-</span></div>
                        <div>Nueva versión: <span id="modalNewVersion">-</span></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="confirmUpdate" class="btn btn-primary">Confirmar</button>
                    <button id="cancelUpdate" class="btn btn-secondary">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Toast notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>
